package tests

import (
	"github.com/distributed-lab/aws-nitro-enclaves-av/internal/pkg/utils"
	"github.com/ethereum/go-ethereum/signer/core/apitypes"
)

const testAttDoc = "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"

var testDomain = apitypes.TypedDataDomain{
	Name:    "Test",
	Version: "v1",
}

var tests = []struct {
	name                string
	primaryType         *string
	fields              []string
	attestationDocument string
	want                string
	wantErr             bool
}{
	{
		name:                "Custom PrimaryType and Fields",
		primaryType:         utils.AsPointer("Pt"),
		fields:              []string{"pcr0"},
		attestationDocument: testAttDoc,
		want:                "WxLS0X5JOQp79DTalZp6LhKGkflOXCmg9BkyDlQDR1Nk3F9qK1XfMVURNLAYPlkyLsZv3j56QxD6W9dMPuS/exw=",
		wantErr:             false,
	},
	{
		name:                "Default PrimaryType and custom Fields",
		primaryType:         nil,
		fields:              []string{"pcr0", "user_data"},
		attestationDocument: testAttDoc,
		want:                "vemuoI5zGsFU3F9XM4PG7xBN4Qw3//KcxjxVKIoXuNF11sJDB44lAZDL6T3MyKLcO5k9lRUl8a8uI5AKRADmihs=",
		wantErr:             false,
	},
}
